<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\City;
use App\Models\Governorate;

class CitySeeder extends Seeder
{
    public function run()
    {
        $cities = [
            'القاهرة' => ['المعادي', 'مدينة نصر', 'التجمع الخامس', 'الزمالك', 'شبرا'],
            'الإسكندرية' => ['العجمي', 'سموحة', 'محرم بك', 'سان ستيفانو', 'بحري'],
            'الجيزة' => ['الدقي', 'المهندسين', '6 أكتوبر', 'الشيخ زايد', 'الهرم'],
            'الدقهلية' => ['المنصورة', 'طلخا', 'ميت غمر', 'بلقاس', 'السنبلاوين'],
            'الشرقية' => ['الزقازيق', 'العاشر من رمضان', 'بلبيس', 'أبو كبير', 'فاقوس'],
            'المنوفية' => ['شبين الكوم', 'منوف', 'الباجور', 'أشمون', 'بركة السبع'],
            'البحيرة' => ['دمنهور', 'كفر الدوار', 'رشيد', 'إدكو', 'المحمودية'],
            'الغربية' => ['طنطا', 'المحلة الكبرى', 'كفر الزيات', 'السنطة', 'سمنود'],
            'بورسعيد' => ['حي الشرق', 'حي العرب', 'المناخ', 'الزهور', 'الضواحي'],
            'دمياط' => ['دمياط الجديدة', 'رأس البر', 'كفر سعد', 'فارسكور', 'الزرقا'],
            'الإسماعيلية' => ['الإسماعيلية', 'فايد', 'القنطرة شرق', 'القنطرة غرب', 'أبو صوير'],
            'السويس' => ['حي السويس', 'حي الأربعين', 'حي فيصل', 'حي عتاقة'],
            'الأقصر' => ['الأقصر', 'إسنا', 'أرمنت', 'البياضية', 'القرنة'],
            'أسوان' => ['أسوان', 'إدفو', 'دراو', 'كوم أمبو', 'نصر النوبة'],
        ];

        foreach ($cities as $governorateName => $cityNames) {
            // البحث عن المحافظة أولاً
            $governorate = Governorate::where('name', $governorateName)->first();

            if ($governorate) {
                foreach ($cityNames as $cityName) {
                    City::updateOrCreate(
                        ['name' => $cityName, 'governorate_id' => $governorate->id],
                        ['name' => $cityName, 'governorate_id' => $governorate->id]
                    );
                }
            }
        }
    }
}
